<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · BayesianDiscovery.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://jsnowynorth.github.io/BayesianDiscovery.jl/api/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">BayesianDiscovery.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../burgers/">Burgers Equation</a></li><li><a class="tocitem" href="../heat/">Heat Equation</a></li><li><a class="tocitem" href="../reactiondiffusion/">Reaction Diffusion</a></li></ul></li><li class="is-active"><a class="tocitem" href>API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/jsnowynorth/BayesianDiscovery.jl/blob/main/docs/src/api.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h1><ul><li><a href="#BayesianDiscovery.DerivativeClass"><code>BayesianDiscovery.DerivativeClass</code></a></li><li><a href="#BayesianDiscovery.Model"><code>BayesianDiscovery.Model</code></a></li><li><a href="#BayesianDiscovery.Pars"><code>BayesianDiscovery.Pars</code></a></li><li><a href="#BayesianDiscovery.Posterior"><code>BayesianDiscovery.Posterior</code></a></li><li><a href="#BayesianDiscovery.DEtection-Tuple{Array{Float64, 3}, Vector, Vector, Int64, Int64, Int64, Int64, Float64, Float64, Function, Function, Vector{String}, Vector{String}}"><code>BayesianDiscovery.DEtection</code></a></li><li><a href="#BayesianDiscovery.bspline-NTuple{4, Any}"><code>BayesianDiscovery.bspline</code></a></li><li><a href="#BayesianDiscovery.construct_state-Tuple{Matrix{Float64}, BayesianDiscovery.DerivativeClass, Matrix{Float64}}"><code>BayesianDiscovery.construct_state</code></a></li><li><a href="#BayesianDiscovery.create_library-Tuple{Function, Vector{String}, Vector{Int64}, BayesianDiscovery.StateClass}"><code>BayesianDiscovery.create_library</code></a></li><li><a href="#BayesianDiscovery.create_pars-Tuple{Array{Float64, 3}, Vector, Vector, Vector{Int64}, Int64, Int64, Int64, Vector{Float64}, Float64, Function, Function, Vector{String}, Vector{String}}"><code>BayesianDiscovery.create_pars</code></a></li><li><a href="#BayesianDiscovery.derivatives_dictionary-Tuple{Int64, Int64, Int64, Int64, Vector, Vector}"><code>BayesianDiscovery.derivatives_dictionary</code></a></li><li><a href="#BayesianDiscovery.fold3-NTuple{4, Any}"><code>BayesianDiscovery.fold3</code></a></li><li><a href="#BayesianDiscovery.make_H-Tuple{Any, Any, Any}"><code>BayesianDiscovery.make_H</code></a></li><li><a href="#BayesianDiscovery.sample_inds-Tuple{Vector, Vector, Int64, Int64, Vector{Int64}, Int64}"><code>BayesianDiscovery.sample_inds</code></a></li><li><a href="#BayesianDiscovery.spatial_bspline-NTuple{7, Any}"><code>BayesianDiscovery.spatial_bspline</code></a></li><li><a href="#BayesianDiscovery.tensor_mult-NTuple{4, Any}"><code>BayesianDiscovery.tensor_mult</code></a></li><li><a href="#BayesianDiscovery.unfold3-Tuple{Array{Float64, 3}}"><code>BayesianDiscovery.unfold3</code></a></li><li><a href="#BayesianDiscovery.update_A!-Tuple{Any, Any}"><code>BayesianDiscovery.update_A!</code></a></li><li><a href="#BayesianDiscovery.update_M!-Tuple{Any, Any}"><code>BayesianDiscovery.update_M!</code></a></li><li><a href="#BayesianDiscovery.update_ΣZ!-Tuple{Any, Any}"><code>BayesianDiscovery.update_ΣZ!</code></a></li><li><a href="#BayesianDiscovery.ΔL-Tuple{Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Matrix{Float64}}"><code>BayesianDiscovery.ΔL</code></a></li></ul><article class="docstring"><header><a class="docstring-binding" id="BayesianDiscovery.DerivativeClass" href="#BayesianDiscovery.DerivativeClass"><code>BayesianDiscovery.DerivativeClass</code></a> — <span class="docstring-category">Type</span></header><section><div><p>DerivativeClass</p><p>Creates the derivative class. Includes:</p><ul><li>TimeDerivative: Derivatives w.r.t. time</li><li>TimeNames: Names of the time derivatives</li><li>SpaceDerivative: Derivatives w.r.t. space</li><li>SpaceNames: Names of the space derivatives</li><li>orderSpace: Order of spatial derivative</li><li>orderTime: Order of temporal derivative</li><li>spatialDimension: 1 if [x] 2 if [x,y]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jsnowynorth/BayesianDiscovery.jl/blob/93550ae6efb38c033dd67453f94166847a59327c/src/basis_functions.jl#L3-L16">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="BayesianDiscovery.Model" href="#BayesianDiscovery.Model"><code>BayesianDiscovery.Model</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Model Structure</code></pre><p>Initiates a structure of class Model</p><p><strong>Arguments</strong></p><ul><li>S: Spatial Dimension</li><li>T</li><li>N</li><li>D</li><li>νS</li><li>νT</li><li>bufferSpace</li><li>bufferTime</li><li>batchSpace</li><li>batchTime</li><li>learning_rate</li><li>Z</li><li>U</li><li>Basis</li><li>States</li><li>Λ::Function: Library of potential functions</li><li>Λnames::Vector{String}: Names of components of library of potential functions</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jsnowynorth/BayesianDiscovery.jl/blob/93550ae6efb38c033dd67453f94166847a59327c/src/ModelStructure.jl#L2-L26">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="BayesianDiscovery.Pars" href="#BayesianDiscovery.Pars"><code>BayesianDiscovery.Pars</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Pars Structure</code></pre><p>Initiates a structure of class Pars</p><p><strong>Arguments</strong></p><ul><li>A: basis coefficients</li><li>M: PDE coefficients</li><li>ΣZ : measurement variance/covariance matrix</li><li>ΣU: process variance/covariance matrix</li><li>gamma: ssvs latent parameters</li><li>sample_inds: current subsampled indicies for SGD</li><li>F: current F</li><li>Fprime: current Fprime</li><li>a_R</li><li>A_R</li><li>nu_R</li><li>a_Q</li><li>A_Q</li><li>nu_Q</li><li>v0</li><li>v1</li><li>Sigma_M</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jsnowynorth/BayesianDiscovery.jl/blob/93550ae6efb38c033dd67453f94166847a59327c/src/ParsStructure.jl#L13-L37">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="BayesianDiscovery.Posterior" href="#BayesianDiscovery.Posterior"><code>BayesianDiscovery.Posterior</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Posterior Struct</code></pre><p>Initiates a structure of class Posterior to hold posterior samples</p><p><strong>Arguments</strong></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jsnowynorth/BayesianDiscovery.jl/blob/93550ae6efb38c033dd67453f94166847a59327c/src/PDE_sampler.jl#L691-L698">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="BayesianDiscovery.DEtection-Tuple{Array{Float64, 3}, Vector, Vector, Int64, Int64, Int64, Int64, Float64, Float64, Function, Function, Vector{String}, Vector{String}}" href="#BayesianDiscovery.DEtection-Tuple{Array{Float64, 3}, Vector, Vector, Int64, Int64, Int64, Int64, Float64, Float64, Function, Function, Vector{String}, Vector{String}}"><code>BayesianDiscovery.DEtection</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">DEtection(Y, SpaceStep, TimeStep, νS, νT, bufferSpace, bufferTime, batchSpace, batchTime, learning_rate, v0, v1, Λ, Λnames)</code></pre><p>DEtection sampler function. Can accept missing values in the input data argument. Returns the model, parameters, and posterior values. The model are the model settings. The parameters are the final value of the parameters in from the sampler. The posterior are the saved posterior values.</p><p>Consider the function <span>$U_t = M(U, U_x, U_y, U_{xy}, ...)$</span>. DEtection() is used to determine <span>$M$</span> given a library of potential values, <code>Λ(U, ∂U)</code>, to search over.  Within the function, partial derivatives are denoted as <span>$ΔU_t, ΔU_x, ΔU_y, ΔU_xx, , ΔU_xy, ...$</span>, so a potential function could be</p><pre><code class="language-julia hljs">function Λ(U, ∂U){
  u = U[1]
  u_x = ∂U[1]
  u_y = ∂U[2]

  return [u, u_x, u_y, u*u_x, u*u_y]
}</code></pre><p>To make the function identify the correct partial derivatives, the argument that are passed into <code>∂U</code>, <code>Λnames</code>, are required. For the example above, <code>Λnames = [ΔU_x, ΔU_y]</code> because the function <code>Λ</code> uses the partial derivatives <span>$U_x$</span> and <span>$U_t$</span>.</p><p>If you want to add covariates to the function, a possible <code>Λ(U, ∂U, X)</code> is</p><pre><code class="language-julia hljs">function Λ(U, ∂U, X){
  u = U[1]
  u_x = ∂U[1]
  u_y = ∂U[2]
  x1 = X[1]
  x2 = X[2]

  return [u, u_x, u_y, u*u_x, u*u_y, x1, x2, u*x1, u_x*x2]
}</code></pre><p>where <code>Λnames = [ΔU_x, ΔU_y]</code>.</p><p><strong>Required Arguments (in order)</strong></p><ul><li><code>Y</code>: Input data. Needs to be Array{Float64, 3} or Array{Union{Missing, Float64}, 3} where the dimensions are Space, Time, Components</li><li><code>SpaceStep</code>: of type StepRangeLen (range function). For example, range(-1, 1, step = 0.1) for 1 dimension and [range(-1, 1, step = 0.1), range(-1, 1, step = 0.1)] for 2.</li><li><code>TimeStep</code>: of type StepRangeLen (range function). For example, range(-1, 1, step = 0.1).</li><li><code>νS::Int</code> or <code>νS::Vector{Int}</code>: Number of spatial basis functions. </li><li><code>νT::Int</code>: Number of temporal basis functions</li><li><code>bufferSpace::Int</code> or <code>bufferSpace::Vector{Int}</code>: Buffer in space.</li><li><code>bufferTime::Int</code>: </li><li><code>batchSpace::Int</code>: </li><li><code>batchTime::Int</code>: </li><li><code>learning_rate::Float64</code>: </li><li><code>v0::Float64</code>: </li><li><code>v1::Float64</code>: </li><li><code>Λ::Function</code>: </li><li><code>Λnames::Vector{String}</code>: </li></ul><p><strong>Optional Arguments</strong></p><ul><li><code>response</code> = &quot;ΔU<em>t&quot;: Order of the temporal derivative (default first order). Use &quot;ΔU</em>tt&quot; for second and so on.</li><li><code>degree</code> = 4: Degree of the B-spline. Must be at least one order higher than the highest order partial derivative.</li><li><code>orderTime</code> = 1: Order of the highest order temporal derivative (default ∂U_t)</li><li><code>orderSpace</code> = 3: Order of the highest order spatial derivative (default ∂U<em>xxx and ∂U</em>yyy)</li><li><code>latent_dim</code> = size(Y, 3): Dimension of the latent space. Default is same as data dimension.</li><li><code>covariates</code> = nothing: Additional covariates.</li><li><code>nits</code> = 2000: Number of samples for the Gibbs sampler.</li><li><code>burnin</code> = nits / 2: Number of samples to discard as burnin (default is half of <code>nits</code>).</li><li><code>learning_rate_end</code> = learning_rate: End learning rate (default is same as initial learning rate).</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">Y = Array{Float64}(rand, 256, 101, 1) # space x time x component, vectorized in space
SpaceStep = [range(-1, 1, step = 0.01), range(-1, 1, step = 0.01)]
TimeStep = range(-1, 1, step = 0.01)
νS = [10, 10] # number of space basis functions
νT = 10 # number of time basis functions
bufferSpace = [2, 2]
bufferTime = 2
batchSpace = 10
batchTime = 10
learning_rate = 1e-2
v0 = 1e-4
v1 = 1e4

Λnames = [&quot;U&quot;, &quot;ΔU_x&quot;, &quot;ΔU_xx&quot;, &quot;ΔU_xxx&quot;]

function Λ(U, ∂U)

  ΔU_x = ∂U[1]
  ΔU_xx = ∂U[2]
  ΔU_xxx = ∂U[3]

  u = U[1]
  u_x = ΔU_x[1]
  u_xx = ΔU_xx[1]
  u_xxx = ΔU_xxx[1]

  return [u, u^2, u^3,
    u_x, u * u_x, u^2 * u_x, u^3 * u_x,
    u_xx, u * u_xx, u^2 * u_xx, u^3 * u_xx,
    u_xxx, u * u_xxx, u^2 * u_xxx, u^3 * u_xxx]

end

# not run
# model, pars, posterior = DEtection(Y, SpaceStep, TimeStep, νS, νT, bufferSpace, bufferTime, batchSpace, batchTime, learning_rate, c, Λ, Λnames)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jsnowynorth/BayesianDiscovery.jl/blob/93550ae6efb38c033dd67453f94166847a59327c/src/PDE_sampler.jl#L1119-L1228">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="BayesianDiscovery.bspline-NTuple{4, Any}" href="#BayesianDiscovery.bspline-NTuple{4, Any}"><code>BayesianDiscovery.bspline</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">bspline(x, knot_locs, degree, derivative)</code></pre><p>Creates a matrix of B-Splines evaluated at each x with specified knot locations and degree. Dimension is (length(x), length(x<em>knot</em>locs)). Returns the basis matrix and the derivative of the basis matrix.</p><p><strong>Arguments</strong></p><ul><li>x: data</li><li>knot_locs: knot locations</li><li>degree: degree of the B-Spline</li><li>derivative: order of the derivative for Psi_x</li></ul><p><strong>Examples</strong></p><pre><code class="nohighlight hljs">x = 1:1:30
knot_locs = 5:5:25
degree = 3
derivative = 1

Psi, Psi_x = bspline(x, knot_locs, degree, derivative)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jsnowynorth/BayesianDiscovery.jl/blob/93550ae6efb38c033dd67453f94166847a59327c/src/basis_functions.jl#L60-L82">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="BayesianDiscovery.construct_state-Tuple{Matrix{Float64}, BayesianDiscovery.DerivativeClass, Matrix{Float64}}" href="#BayesianDiscovery.construct_state-Tuple{Matrix{Float64}, BayesianDiscovery.DerivativeClass, Matrix{Float64}}"><code>BayesianDiscovery.construct_state</code></a> — <span class="docstring-category">Method</span></header><section><div><p>construct<em>state(;A::Array{Float64, 2},                         Time</em>derivative::Dict, Time<em>names::Vector{String},                         Space</em>derivative::Dict, Space_names::Vector{String})</p><p>Creates a dictionary and corresponding names of the space and time derivatives. Used only for 1 spatial dimension.</p><p><strong>Arguments</strong></p><ul><li>A::Array{Float64, 2}</li><li>BasisDerivative::DerivativeClass</li><li>Theta: Dimension of components diagonal matrix</li></ul><p><strong>Examples</strong></p><pre><code class="nohighlight hljs">ProcessDerivative = construct_state(A, BasisDerivative, Theta)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jsnowynorth/BayesianDiscovery.jl/blob/93550ae6efb38c033dd67453f94166847a59327c/src/basis_functions.jl#L320-L337">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="BayesianDiscovery.create_library-Tuple{Function, Vector{String}, Vector{Int64}, BayesianDiscovery.StateClass}" href="#BayesianDiscovery.create_library-Tuple{Function, Vector{String}, Vector{Int64}, BayesianDiscovery.StateClass}"><code>BayesianDiscovery.create_library</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">create_create_library(Λ, Λnames, locs, State)</code></pre><p>Create a matrix of the function Λ evaluated at each location</p><p><strong>Arguments</strong></p><ul><li>Λ: function</li><li>Λnames: names of each component of Λ</li><li>llocs: space-time locations to evaluate the function at</li><li>State: StateClass current state of values</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jsnowynorth/BayesianDiscovery.jl/blob/93550ae6efb38c033dd67453f94166847a59327c/src/basis_functions.jl#L390-L401">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="BayesianDiscovery.create_pars-Tuple{Array{Float64, 3}, Vector, Vector, Vector{Int64}, Int64, Int64, Int64, Vector{Float64}, Float64, Function, Function, Vector{String}, Vector{String}}" href="#BayesianDiscovery.create_pars-Tuple{Array{Float64, 3}, Vector, Vector, Vector{Int64}, Int64, Int64, Int64, Vector{Float64}, Float64, Function, Function, Vector{String}, Vector{String}}"><code>BayesianDiscovery.create_pars</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">create_pars()</code></pre><p>Constructs the parameter and model classes.</p><p>See also <a href="#BayesianDiscovery.Pars"><code>Pars</code></a>, <a href="#BayesianDiscovery.Model"><code>Model</code></a>.</p><p><strong>Arguments</strong></p><ul><li>Y::Array{Float64, 3}: Space x Time x Component data array</li><li>SpaceStep::Vector{StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}}}: Vector of spatial locations [x, y]</li><li>TimeStep::StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}}: Time samples</li><li>νS::Vector{Int32}: number of spatial basis functions [x, y]</li><li>νT::Int: number of temporal basis functions</li><li>bufferSpace::Vector{Int}: spatial buffer [x, y]</li><li>bufferTime::Int: temporal buffer</li><li>batchSpace::Int: batch size for space [x, y]</li><li>batchTime::Int: batch size for time</li><li>learning_rate::Float64: learning rate</li><li>v0::Float64: ssvs not included variance</li><li>v1::Float64: ssvs included variance</li><li>Λ::Function: function library</li><li>Λnames::Vector{String}: names of arguments in function library</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jsnowynorth/BayesianDiscovery.jl/blob/93550ae6efb38c033dd67453f94166847a59327c/src/ParsStructure.jl#L74-L97">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="BayesianDiscovery.derivatives_dictionary-Tuple{Int64, Int64, Int64, Int64, Vector, Vector}" href="#BayesianDiscovery.derivatives_dictionary-Tuple{Int64, Int64, Int64, Int64, Vector, Vector}"><code>BayesianDiscovery.derivatives_dictionary</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">derivatives_dictionary(;orderx::Int, orderTime::Int, νT::Int, νS::Int,
                            Δx::Float64, Δt::Float64, degree::Int,
                            x::StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}},
                            Time::StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}})</code></pre><p>Creates a dictionary of space and time derivatives and their names. Used only for 1 spactial dimension.</p><p><strong>Arguments</strong></p><ul><li><p>orderx::Int order of the x derivatives (spatial)</p></li><li><p>orderTime::Int order of the time derivatives</p></li><li><p>νT::Int number of time basis functions</p></li><li><p>νS::Int number of space basis functions</p></li><li><p>degree::Int degree of bsplines</p></li><li><p>x::StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}} x (spatial) values</p></li><li><p>Time::StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}} time values</p></li><li><p>orderSpace::Int: order of the spatial derivatives</p></li><li><p>orderTime::Int: order of the time derivative</p></li><li><p>νS::Int, νS::Array{Int}: either number of spatial basis functions for 1 dimension or [x,y] dimensions</p></li><li><p>νT::Int: number of time basis functions</p></li><li><p>SpaceStep::StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}}: in 1 dim spatial indexes or [x,y] spatial indexes</p></li><li><p>TimeStep::StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}}: temporal indexes</p></li><li><p>degree::Int = 4: degree of bspline</p></li></ul><p><strong>Examples</strong></p><pre><code class="nohighlight hljs">x = 2:0.05:7.5
y = -2.5:0.05:2.5
Time = 0:0.08:16
Δt = 0.08

νSx = 10
νSy = 10
νT = 10
degree = 4
orderTime = 1
orderSpace = 3

BasisDerivative = derivatives_dictionary(orderSpace, orderTime, [νSx, νSy], νT, [x, y], Time)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jsnowynorth/BayesianDiscovery.jl/blob/93550ae6efb38c033dd67453f94166847a59327c/src/basis_functions.jl#L190-L231">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="BayesianDiscovery.fold3-NTuple{4, Any}" href="#BayesianDiscovery.fold3-NTuple{4, Any}"><code>BayesianDiscovery.fold3</code></a> — <span class="docstring-category">Method</span></header><section><div><p>fold3(Y)</p><p>Used to construct a tensor from the mode-3 matrix Y.</p><p><strong>Examples</strong></p><p>Y3 = unfold3(Y) I = size(Y, 1) J = size(Y, 2) K = size(Y, 3)</p><p>Y = fold3(Y3, I, J, K)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jsnowynorth/BayesianDiscovery.jl/blob/93550ae6efb38c033dd67453f94166847a59327c/src/tensor_functions.jl#L66-L80">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="BayesianDiscovery.make_H-Tuple{Any, Any, Any}" href="#BayesianDiscovery.make_H-Tuple{Any, Any, Any}"><code>BayesianDiscovery.make_H</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">make_H(M, N, one_inds)</code></pre><p>Used to construct the mapping matrix H</p><p><strong>Arguments</strong></p><ul><li><code>M::</code>: something</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jsnowynorth/BayesianDiscovery.jl/blob/93550ae6efb38c033dd67453f94166847a59327c/src/PDE_sampler.jl#L711-L719">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="BayesianDiscovery.sample_inds-Tuple{Vector, Vector, Int64, Int64, Vector{Int64}, Int64}" href="#BayesianDiscovery.sample_inds-Tuple{Vector, Vector, Int64, Int64, Vector{Int64}, Int64}"><code>BayesianDiscovery.sample_inds</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">sample_inds()</code></pre><p>returns the space indices, time indices, and vectorized indices</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jsnowynorth/BayesianDiscovery.jl/blob/93550ae6efb38c033dd67453f94166847a59327c/src/basis_functions.jl#L551-L556">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="BayesianDiscovery.spatial_bspline-NTuple{7, Any}" href="#BayesianDiscovery.spatial_bspline-NTuple{7, Any}"><code>BayesianDiscovery.spatial_bspline</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">spatial_bspline(x, y, x_knot_locs, y_knot_locs, degree)</code></pre><p>Creates a matrix of B-Splines evaluated at each x and y with specified knot locations and degree. Dimension is (length(x)<em>length(y), length(x<em>knot</em>locs)</em>length(y<em>knot</em>locs)). Returns the basis matrix and the derivative of the basis matrix.</p><p><strong>Arguments</strong></p><ul><li>x: data in the x direction</li><li>y: data in the x direction</li><li>x<em>knot</em>locs: knot locations for x</li><li>y<em>knot</em>locs: knot locations for y</li><li>degree: degree of the B-Spline</li></ul><p><strong>Examples</strong></p><pre><code class="nohighlight hljs">x = 1:1:30
y = 1:1:30
x_knot_locs = 5:5:25
y_knot_locs = 5:5:25
degree = 3

Psi, Psi_x, Psi_y, Psi_xy = spatial_bspline(x, y, x_knot_locs, y_knot_locs, degree)

# plot the functions
Plots.pyplot()
contour(x, y, reshape(Psi, length(x), length(y)), fill = true)
contour(x, y, reshape(Psi_x, length(x), length(y)), fill = true)
contour(x, y, reshape(Psi_y, length(x), length(y)), fill = true)
contour(x, y, reshape(Psi_xy, length(x), length(y)), fill = true)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jsnowynorth/BayesianDiscovery.jl/blob/93550ae6efb38c033dd67453f94166847a59327c/src/basis_functions.jl#L112-L143">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="BayesianDiscovery.tensor_mult-NTuple{4, Any}" href="#BayesianDiscovery.tensor_mult-NTuple{4, Any}"><code>BayesianDiscovery.tensor_mult</code></a> — <span class="docstring-category">Method</span></header><section><div><p>tensor_mult(G, A, B, C)</p><p>Used to multiply a tensor G ∈ R(I1, I2, I3) with matrices A ∈ R(P, I1), B ∈ R(Q, I2), C ∈ R(R, I3)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jsnowynorth/BayesianDiscovery.jl/blob/93550ae6efb38c033dd67453f94166847a59327c/src/tensor_functions.jl#L4-L9">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="BayesianDiscovery.unfold3-Tuple{Array{Float64, 3}}" href="#BayesianDiscovery.unfold3-Tuple{Array{Float64, 3}}"><code>BayesianDiscovery.unfold3</code></a> — <span class="docstring-category">Method</span></header><section><div><p>unfold3(Y)</p><p>Used to get the mode-3 matrix of the tensor Y.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jsnowynorth/BayesianDiscovery.jl/blob/93550ae6efb38c033dd67453f94166847a59327c/src/tensor_functions.jl#L29-L34">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="BayesianDiscovery.update_A!-Tuple{Any, Any}" href="#BayesianDiscovery.update_A!-Tuple{Any, Any}"><code>BayesianDiscovery.update_A!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">update_A!(pars)</code></pre><p>Used within DEtection() function with a spike-and-slab prior. Updates 𝐀 with the elastic net prior (Li 2010) from</p><p><span>$𝐳(𝐬, t) = ℋ(𝐬,t) 𝚯 𝐀 (𝛗phi_{t^{(0)}}(t) ⊗ 𝛙(𝐬))&#39; + 𝛜(𝐬, t)$</span></p><p><span>$𝚯 𝐀 (𝛗_{t^{(i)}}(t) ⊗ g(𝛙(𝐬)))&#39; = 𝐌 𝐟(⋅) + 𝛈(𝐬, t)$</span> </p><p><span>$p(𝐀) ∝ exp{-λ₁‖𝐀‖₁ - λ₂‖𝐀‖₂²}$</span></p><p>using Stochastic Gradient Desent with a Constant Learning Rate (Mandt 2016). λ₁ and λ₂ are set to 1/100.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jsnowynorth/BayesianDiscovery.jl/blob/93550ae6efb38c033dd67453f94166847a59327c/src/PDE_sampler.jl#L1049-L1064">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="BayesianDiscovery.update_M!-Tuple{Any, Any}" href="#BayesianDiscovery.update_M!-Tuple{Any, Any}"><code>BayesianDiscovery.update_M!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">update_M!(pars)</code></pre><p>Used within DEtection() function with a spike-and-slab prior. Updates 𝐌 and 𝚺ᵤ from </p><p><span>$𝚯 𝐀 (𝛗_{t^{(i)}}(t) ⊗ g(𝛙(𝐬)))&#39; = 𝐌 𝐟(⋅) + 𝛈(𝐬, t)$</span> </p><p>where <span>$𝛈(𝐬, t) ∼ N_N(0, 𝚺ᵤ)$</span>and <span>$𝚺ᵤ = diag(σ²ᵤ1, ..., σ²ᵤN)$</span></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jsnowynorth/BayesianDiscovery.jl/blob/93550ae6efb38c033dd67453f94166847a59327c/src/PDE_sampler.jl#L727-L736">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="BayesianDiscovery.update_ΣZ!-Tuple{Any, Any}" href="#BayesianDiscovery.update_ΣZ!-Tuple{Any, Any}"><code>BayesianDiscovery.update_ΣZ!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>update_ΣZ!(pars)</p><p>Used within DEtection() function with a spike-and-slab prior. Updates 𝚺z from </p><p><span>$𝐳(𝐬, t) = ℋ(𝐬,t) 𝚯 𝐀 (𝛗phi_{t^{(0)}}(t) ⊗ 𝛙(𝐬))&#39; + 𝛜(𝐬, t)$</span></p><p>where <span>$𝛜(𝐬, t) ∼ N_N(0, 𝚺z)$</span>, <span>$𝚺z = diag(σ²z1, ..., σ²zm)$</span>, and <span>$σ²z ∼ Half-t()$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jsnowynorth/BayesianDiscovery.jl/blob/93550ae6efb38c033dd67453f94166847a59327c/src/PDE_sampler.jl#L954-L964">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="BayesianDiscovery.ΔL-Tuple{Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Matrix{Float64}}" href="#BayesianDiscovery.ΔL-Tuple{Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Matrix{Float64}}"><code>BayesianDiscovery.ΔL</code></a> — <span class="docstring-category">Method</span></header><section><div><p>ΔL(z, H, ψ, gψ, ϕ, ϕ_t, Θ, ΣZinv, ΣUinv, A, M, fcurr, fprime)</p><p>Used within DEtection() function. Calculates the gradient of the log likelihood.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jsnowynorth/BayesianDiscovery.jl/blob/93550ae6efb38c033dd67453f94166847a59327c/src/PDE_sampler.jl#L988-L993">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../reactiondiffusion/">« Reaction Diffusion</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Thursday 13 April 2023 17:12">Thursday 13 April 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
